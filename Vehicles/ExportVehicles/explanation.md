The goal of this refactoring is to make code clean, readable, and maintainable by removing duplication and making the code more modular.
Goal is to make it well written prose.

[]: # The code is more modular because the code is split into smaller functions that each do one thing.
[]: # The code is more readable because the function names are descriptive and the code is split into smaller functions.
[]: # The code is more maintainable because the code is split into smaller functions that each does one thing.
[]: # The code is more maintainable because the function names are descriptive.
